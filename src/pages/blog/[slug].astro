---
import { getFirstBlogPost,UrlForImage } from "../../lib/api";
import PortableText from "../../components/PortableText.astro";
import LayoutBlog from '../../layouts/LayoutBlog.astro'
 import {Image} from '@astrojs/image/components';
export async function getStaticPaths() {
  const allBlogPosts = await getFirstBlogPost();
  return allBlogPosts.map((post) => ({
    params: {
      slug: post.slug.current,
    },
    props: {
      post,
      
    },
  }));
}

const { post } = Astro.props;


---

<LayoutBlog>
  <div class="max-w-2xl mx-auto p-4">
    <h1 class="text-3xl font-bold my-4">{post.title}</h1>
 
    {post.mainImage && (
      <div class="mb-4">
        <Image
          src={UrlForImage(post.mainImage).url()}
          alt={post.mainImage.alt}
          class="rounded-lg shadow-md "
          width={750}
          height={350}
         
        />
      </div>
    )}
        {post.recipes && (
      <div class="my-4">
        <h2 class="text-2xl font-bold mb-2">Recipes</h2>
        {post.recipes.map((recipe) => (
          <div key={recipe._key} class="mb-4">
            <h3 class="text-xl font-semibold">{recipe.title}</h3>
            <h4 class="text-lg font-medium">Ingredients:</h4>
            <ul class="list-disc ml-6">
              {recipe.ingredients.map((ingredient, index) => (
                <li key={index} class="mb-1">
                  {ingredient.trim()}
                </li>
              ))}
            </ul>
            <h4 class="text-lg font-medium">Instructions:</h4>
            <ol class="list-decimal ml-6">
              {recipe.instructions.split("\n").map((instruction, index) => (
                <li key={index} class="mb-1">
                  {instruction.trim()}
                </li>
              ))}
            </ol>
          </div>
        ))}
      </div>
    )}


    <PortableText portableText={post.body} />

    {post.nutrition && (
      <div class="my-4">
        <h2 class="text-2xl font-bold mb-2">Nutrition Facts</h2>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <p class="font-semibold">Calories:</p>
            <p>{post.nutrition.calories}</p>
          </div>
          <div>
            <p class="font-semibold">Carbohydrates:</p>
            <p>{post.nutrition.carbohydrates}</p>
          </div>
          <div>
            <p class="font-semibold">Fat:</p>
            <p>{post.nutrition.fat}</p>
          </div>
          <div>
            <p class="font-semibold">Protein:</p>
            <p>{post.nutrition.protein}</p>
          </div>
        </div>
      </div>
    )}

  </div>
</LayoutBlog>





